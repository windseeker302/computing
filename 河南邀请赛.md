# 2023河南省云计算邀请赛

## 【模块一】Linux基础

【1】Python理论
Python是一种编译型语言。（）
【2】云计算利用率
云计算可以进行有效的资源整合，解决资源闲置问题，提高资源的利用率。（）
【3】Linux命令使用
在Linux中，文件和目录的权限可以使用chmod命令进行修改。（）
【4】容器技术
容器是一种沙盒技术, 主要目的是为了将应用运行在其中并与外界隔离, 方便这个沙盒可以被转移到其他宿主机器。（）
【5】容器内核技术
容器的内核技术包括Cgroup和Namespace。（）
【6】内核判断
内核是操作系统最基本的部分。（）
【7】云计算判断
云计算是互联网和计算技术发展的产物，因此云计算一定离不开网络。（）
【8】Linux命令基本使用
在Linux中，下列哪些命令是可以用来压缩文件的？（）
tar
compress
mv
gzip
【题目2】云计算部署模型
下列选项当中，哪些是云计算的部署模型？（）
公有云
私有云
混合云
在线云
【题目3】云计算资源池化
云计算将资源池化然后供用户使用，一般情况是将哪些资源进行池化？（）
计算资源
镜像资源
存储资源
网络资源
【题目4】云计算描述
下列关于公有云和私有云的描述正确的是？（）
私有云是为企业内部使用而构建的计算架构
公有云能够以低廉的价格，提供有吸引力的服务给最终用户，创造新的业务价值
公有云是云服务提供商通过自己的基础设施直接向外部用户提供服务
构建私有云比使用公有云更便宜
【题目5】容器化技术优势
云计算中的容器化技术（如Docker）的优势包括：（）
更高的性能
更轻量级的虚拟化
可以替代云服务
独立性和可移植性

## 【模块二】私有云

【1】基础环境配置
使用提供的用户名密码，登录提供的OpenStack私有云平台，在当前租户下，使用CentOS7.9镜像，创建两台云主机，云主机类型使用4vCPU/12G/100G_50G类型。当前租户下默认存在一张网卡，自行创建第二张网卡并连接至controller和compute节点（第二张网卡的网段为10.10.X.0/24，X为工位号，不需要创建路由）。自行检查安全组策略，以确保网络正常通信与ssh连接，然后按以下要求配置服务器：
（1）设置控制节点主机名为controller，设置计算节点主机名为compute；
（2）修改hosts文件将IP地址映射为主机名；
【2】Yum源配置
使用提供的http服务地址，在http服务下，存在centos7.9和iaas的网络yum源，使用该http源作为安装iaas平台的网络源。分别设置controller节点和compute节点的yum源文件http.repo。
【3】配置无秘钥ssh
配置controller节点可以无秘钥访问compute节点，配置完成后，尝试ssh连接compute节点的hostname进行测试。
【4】基础安装
在控制节点和计算节点上分别安装openstack-iaas软件包，根据表2配置两个节点脚本文件中的基本变量（配置脚本文件为/etc/openstack/openrc.sh）。

表2 云平台配置信息

| 服务名称         | 变量               | 参数/密码 |
| ---------------- | ------------------ | --------- |
| Mysql            | root               | 000000    |
| Keystone         | 000000             |           |
| Glance           | 000000             |           |
| Nova             | 000000             |           |
| Neutron          | 000000             |           |
| Heat             | 000000             |           |
| Zun              | 000000             |           |
| Keystone         | DOMAIN_NAME        | demo      |
| Admin            | 000000             |           |
| Rabbit           | 000000             |           |
| Glance           | 000000             |           |
| Nova             | 000000             |           |
| Neutron          | 000000             |           |
| Heat             | 000000             |           |
| Zun              | 000000             |           |
| Neutron          | Metadata           | 000000    |
| External Network | eth1（以实际为准） |           |

【5】数据库安装与调优
在controller节点上使用iaas-install-mysql.sh 脚本安装Mariadb、Memcached、RabbitMQ等服务。
【6】Keystone服务安装与使用
在controller节点上使用iaas-install-keystone.sh脚本安装Keystone服务。
【7】Glance安装与使用
在controller节点上使用iaas-install-glance.sh脚本安装glance服务。
【8】Nova安装与优化
在控制节点和计算节点上分别安装Nova服务。安装完成后，完成Nova相关配置。
【9】Neutron安装
在控制和计算节点上正确安装Neutron服务。
【10】Dashboard安装
在控制节点上安装Dashboard服务。安装完成后，将Dashboard中的 Django数据修改为存储在文件中。

~~~shell
vim /etc/openstack-dashboard/local_settings
# 修改
104 SESSION_ENGINE = 'django.contrib.sessions.backends.file'

# 重启服务
systemctl restart httpd
~~~



【11】Swift安装
在控制节点和计算节点上分别安装Swift服务。安装完成后，将cirros镜像进行分片存储。

~~~shell
# 创建examcontainer容器
# controller
openstack container create examcontainer

# swfit切片上传cirros
# -S 上载不大于<size>（字节）的段中的文件，然后创建一个“清单”文件，该文件将下载所有段，就像它是原始文件一样。
# 分片 10 M
swift upload examcontainer -S 10485760 cirros-0.3.4-x86_64-disk.img
~~~



【12】Cinder创建硬盘
在控制节点和计算节点分别安装Cinder服务，请在计算节点，对块存储进行扩容操作。

~~~shell
# cinder 服务的存由 lvm 创建，我们只需要给计算节点上的cinder卷组，扩容，即可完成此题目
pvcreate <新硬盘>
vgextend cinder-volumes <新pv>
~~~



【13】入侵检测系统
使用提供的makechk.tar.gz包安装chkrootkit入侵检测工具，安装完毕后使用chkrootkit工具扫描系统，并将扫描结果保存到/var/log/chkrootkit/chkrootkit.log，根据扫描的结果，修复漏洞。

~~~shell


~~~



【题目14】日志分析服务
自行配置YUM源安装Docker服务，然后使用提供的sepb_elk_latest.tar镜像安装ELK服务，安装完成后，进行添加数据操作，将ELK监控目标节点所需安装的RPM安装包下载到本地云主机的/root目录下。

~~~shell

~~~



## 【模块三】容器云

【1】基础环境配置
使用提供的用户名密码，登录提供的OpenStack私有云平台，在当前租户下，有两台创建好的云主机。自行检查安全组策略，以确保网络正常通信与ssh连接，然后按以下要求配置服务器：
（1）设置主节点主机名为master，设置从节点主机名为nodel；
（2）修改hosts文件将IP地址映射为主机名。
【2】Yum源配置
使用提供的http服务地址，在http服务下，存在centos7.9的网络yum源，使用该http源作为安装服务的网络源。分别设置master节点和node节点的yum源文件http.repo。
【3】平台部署--部署容器云平台
使用master和node两台云主机，通过kubeeasy工具完成Kubernetes 1.25.2集群的搭建。

~~~shell
mount chinaskills_cloud_paas_v2.0.2.iso /mnt/
cp -rfv /mnt/* /opt
mv /opt/kubeeasy /usr/local/bin/

# 使用 kubeeasy 安装依赖
  kubeeasy install dependencies \
  --host 172.129.78.151,172.129.78.164 \		# # 所有主机节点IP，如：10.24.1.2-10.24.1.10，中间用“-”隔开，表示10.24.1.2到10.24.1.10范围内的所有IP。若IP地址不连续，则列出所有节点IP，用逗号隔开，如：10.24.1.2,10.24.1.7,10.24.1.9。
  --user root \			# 主机登录用户，默认为root
  --password 000000 \			# 主机所有密码，所有节点需保持密码一致
  --offline-file /opt/dependencies/packages.tar.gz			# 离线安装包路径



# 使用 kubeeasy 安装 k8s
  kubeeasy install kubernetes \
  --master 172.129.78.151 \
  --worker 172.129.78.164 \
  --user root \
  --password 000000 \
  --version 1.25.2 \
  --offline-file /opt/kubeeasy.tar.gz
~~~



【4】Docker创建容器操作
使用nginx镜像创建一个名为 chinaskills 的容器，确保容器在后台运行，并映射容器的80端口到主机的5080端口。

~~~shell
docker --itd --name chinaskills -p 5080:80 nginx:latest
~~~



【5】Docker查询容器操作
使用Docker命令列出当前系统上所有正在运行的容器，并输出应包含容器的ID、名称、使用的镜像等信息。将输出的信息重定向到/root/dockerinfo.txt文件中。

~~~shell
docker ps  > /root/dockerinfo.txt
~~~



【6】Dockerfile编写
在容器节点上编写/root/nginx/Dockerfile文件构建chinaskill-nginx:v1.0镜像，具体要求如下：
（1）基础镜像：nginx:latest；
（2）index.html文件内容为HelloWorld；
（3）声明端口80；
（4）设置服务开机自启。

~~~shell
# 创建dockerfile文件
[root@localhost ~]# vim ws
from nginx:latest

copy index.html /usr/share/nginx/html

workdir /app

expose 80

cmd ["nginx","-g","daemon off;"]

# 构建镜像
docker build -t chinaskill-nginx:v1.0 -f ws .	
~~~



## 【模块四】边缘计算

【1】云端部署
在OpenStack平台上使用k8s-allinone-v1.22.1镜像创建云主机，并使用提供的软件包（kubernetes_kubeedge.tar.gz）完成云端部署KubeEdge CloudCore云测模块，并启动cloudcore服务。
云端包括Router、DeviceController、CloudStream等模块，负责监听云端资源的变化，提供可靠和高效的云边消息同步。



【2】边端部署
在公有云环境中，创建两台centos7.9云主机做为边缘端节点。完成KubeEdge edgecore边端模块部署，启动edgecore服务。
边端主要是EdgeCore组件，包含Edged、MetaManager、EdgeHub等模块，通过接收云端的消息，负责容器的生命周期管理。
在云端cloudcore和边端edgecore中，通过模块服务来启用KubeEdge的高级特性功能，使云端可以通过模块服务，正常收集到边缘端的数据指标，管理边缘端的数据。



【3】FastAPI GET请求接口开发
使用现有的开发环境，基于FastAPI框架实现一组API，具体要求如下：
（1）定义接口/items/{item_id}，请求为GET，该接口接受一个参数item_id,并且为int类型，该接口有一个可选的str查询参数，查询参数名为query，在调用该接口时，返回的数据为JSON数据，内容为 {"item_id": 1, "query": "23"}；
（2）定义接口/hello，请求为GET，在调用该接口时，返回数据格式为JSON数据，内容为{"Hello": "World"}



~~~python
from typing import Optional
from fastapi import FastAPI
import uvicorn

# 创建一个 FastAPI实例
app = FastAPI()


# （1）定义接口/items/{item_id}，请求为GET，该接口接受一个参数item_id,并且为int类型，该接口有一个可选的str查询参数，
# 查询参数名为query，在调用该接口时，返回的数据为JSON数据，内容为 {"item_id": 1, "query": "23"}；
# 定义路径操作装饰器
@app.get("/items/{item_id}")
def read_item(item_id: int, query: Optional[str] = None):
    return {
        "item_id": item_id,
        "query": query
    }

# （2）定义接口/hello，请求为GET，在调用该接口时，返回数据格式为JSON数据，内容为{"Hello": "World"}；
@app.get("/hello")
def read_item():
    return {"Hello": "World"}

if __name__ == '__main__':
    uvicorn.run(app)
~~~



